# Compute ISFR stats

## Introduction

This is a PowerShell script which will generate a list of all compute in your tenant (virtual machines and virtual machine scale sets) with SKU details expressed as an instance size flexibility ratio (ISFR).

## Report

The final report generated by this script will include the following details of all compute:

- Subscription
- Resource Group
- Location
- Name
- SKU Name
- Count
    - 1 if type is of VM
    - N (where N is the number of instances in a VMSS)
- Type
    - where type is either `microsoft.compute/virtualmachines` or `microsoft.compute/virtualmachinescalesets`
- Instance size flexibility group
- Ratio
    - the ISFR ratio relative to compute SKU
- Lowest common SKU
- Lowest common SKU count
    - Compute quantity expressed in terms of the lowest common SKU

## Report

### Example output

The CSV file output will look something like this:

| subscriptionName | resourceGroup    | location | name          | skuName         | count | type                                      | InstanceSizeFlexibilityGroup | Ratio | LowestCommonSku | LowestCommonSkuCount |
|------------------|------------------|----------|---------------|-----------------|-------|-------------------------------------------|------------------------------|-------|-----------------|----------------------|
| acme-nonprod-01  | choco-nonprod-rg | uksouth  | vm-x-y-z      | Standard_E8s_v5 | 1     | microsoft.compute/virtualmachines         | Esv5 Series                  | 4     | Standard_E2s_v5 | 4                    |
| acme-prod-01     | choco-prod-rg    | uksouth  | vmss-aa-bb-cc | Standard_D8d_v5 | 99    | microsoft.compute/virtualmachinescalesets | Ddv5 Series                  | 4     | Standard_D2d_v5 | 396                  |

## Access requirements

The script should be run as a principal (e.g. user account or service principal) with a minimum of **Reader** access against the scope you wish to analyse compute for (e.g. subscription scope or management group scope).
